<div class="icon-picker-container">
  <p-iftalabel [class.disabled]="disabled()" [class.required]="required()">
    <div class="icon-display-wrapper" [id]="id()" [matMenuTriggerFor]="iconMenu" [class.readonly]="readonly()"
      [class.disabled-state]="disabled()">
      <div class="icon-preview">
        <fin-icon [icon]="selectedIcon" />
      </div>
      <div class="icon-value">{{ selectedIcon }}</div>
      <fin-icon icon="chevron-down" class="dropdown-icon" />
    </div>
    <label [for]="id()">{{ label() | finTranslate }}</label>
  </p-iftalabel>

  <mat-menu #iconMenu="matMenu" class="icon-picker-menu">
    <div class="icon-picker-content" (click)="$event.stopPropagation()">
      <div class="icon-grid">
        @for (icon of predefinedIcons; track icon) {
        <div class="icon-option" [class.selected]="isIconSelected(icon)" (click)="selectIcon(icon)">
          <fin-icon [icon]="icon" class="option-icon" />
          @if (isIconSelected(icon)) {
          <div class="selected-indicator">
            <fin-icon icon="check" class="check-icon" />
          </div>
          }
        </div>
        }
      </div>

      <div class="custom-icon-section">
        <div class="custom-icon-header">
          <label class="custom-icon-label">{{ 'finCore.features.shared.customIcon' | finTranslate }}</label>
          <button type="button" class="font-awesome-link" (click)="openFontAwesome()">
            <fin-icon icon="external-link" />
            <span>Font Awesome</span>
          </button>
        </div>
        <div class="custom-icon-input-wrapper">
          <div class="icon-input-preview">
            <fin-icon [icon]="customIconInput()" />
          </div>
          <input type="text" [value]="customIconInput()" (input)="onCustomIconChange($event)"
            [placeholder]="'finCore.features.shared.typeCustomIcon' | finTranslate" class="icon-name-input"
            pInputText />
        </div>
      </div>
    </div>
  </mat-menu>

  <div class="sub-text">
    @if (!hasError()) {
    <fin-text [text]="helpText()" class="info-sub" type="info" />
    } @else {
    <fin-text [text]="errorMessageEffective()" class="error-sub" type="info" />
    }
  </div>
</div>